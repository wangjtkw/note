# 第一章 操作系统引论

## 1.1 操作系统的目标和作用

### 1.1.1 操作系统的目标：

方便性、有效性、可扩充性、开放性。

### 1.1.2 操作系统的作用：

- 作为用户与计算机硬件系统之间的接口；
- 作为计算机系统资源的管理者；
- 实现对计算机资源的抽象；

## 1.2 操作系统的发展过程

### 1.2.1 未配置操作系统的计算机系统

- 人工操作方式：
  - 独占全机；
  - CPU等待人工操作；严重降低计算机资源的利用率，此即所谓人机矛盾。
- 脱机输入/输出(Off-Line I/O)方式：
  - 减少了CPU的空闲时间；
  - 提高了I/O的速度。

### 1.2.2 单道批处理系统

单道批处理系统是在解决人际矛盾和CPU与I/O设备速度不匹配矛盾的过程中形成的；

批处理系统旨在提高系统资源的利用率和系统吞吐量；

但这种单道批处理系统仍不能充分的利用系统资源。

缺点：

- 内存中仅有一道程序；
- 每逢该程序在运行中发出I/O请求后，CPU便处于等待状态。

### 1.2.3 多道批处理系统

1. 多道程序设计的基本该概念：
   - 用户所提交的作业先存放在外存上，并排成一个队列，称为"后备队列"；
   - 系统可利用其他程序在进行I/O操作的空档期，调度其他程序运行。
2. 多道批处理系统的优缺点：
   - 资源利用率高；
   - 系统吞吐量大；
   - 平均周转时间长；
   - 无交互能力。
3. 多道批处理系统需要解决的问题：
   - 处理机征用问题；
   - 内存分配和保护问题；
   - I/O设备分配问题；
   - 文件的组织和管理问题；
   - 作业管理问题；
   - 用户与系统的接口问题。

### 1.2.4 分时系统

1. 分时系统的引入：

   - 人机交互。对程序进行直接控制，以方便对程序中的错误进行修改；
   - 共享主机。每个人都希望独占计算机，并且感受不到其他用户的存在。

   分时系统允许多个系统同时通过自己的终端，以交互方式使用计算机，共享主机中的资源。

2. 分时系统实现的关键问题：

   - 及时接收。通过配置多路卡，周期性的扫描各个终端；
   - 及时处理。可以采用让作业直接进入内存或者采用轮转运行方式。

3. 分时系统的特征：

   - 多路性；
   - 独占性；
   - 及时性；
   - 交互性。

### 1.2.5 实时系统

1. 实时系统的类型：

   - 工业(武器)控制系统；
   - 信息查询系统；
   - 多媒体系统；
   - 嵌入式系统。

2. 实时任务的类型：

   - 周期性实时任务和非周期性实时任务：

     - 周期性任务是指外部设备周期性的发出激励信号给计算机，要求他按指定周期循环执行。
     - 非周期性任务无明显周期，但必须有一个截止时间，或称为最后期限。分为开始截至时间和完成截止时间。

   - 硬实时任务和软实时任务：

     - 硬实时任务是指系统必须满足任务对截止时间的要求，否则可能造成难以预测的后果。
     - 软实时任务也要求一个截至时间，但偶尔错过任务截至时间，对系统产生的影响也不大。

   - 实时系统与分时系统的比较：

     - 多路性：

       - 信息查询系统和分时系统多路性表现为系统按分时原则为多个终端用户服务。
       - 实时控制系统多路性是指系统周期性的对多路现场信息进行采集。

     - 独立性：

       - 信息查询系统中每个终端用户与系统进行交互时，彼此之间相互独立不干扰。
       - 实时系统，对信息的采集和对对象的控制也互不干扰。

     - 及时性：

       - 信息查询系统对实时性的要求是根据人所能接受的等待时间来确定。
       - 实时控制系统则是以控制对象所要求的截至时间来确定。

     - 交互性：

       - 分时系统能像终端用户提供数据处理、资源共享等服务。

       - 在信息查询系统中，人与系统的交互性仅限于访问系统中某些特定的专用服务程序。

     - 可靠性：

       - 分时系统要求系统可靠。
       - 实时系统要求系统高度可靠。

### 1.2.6 微机操作系统的发展

1. 单用户单任务操作系统：只允许一个用户上机，且只允许用户程序作为一个任务运行。
2. 单用户多任务操作系统：只允许一个用户上机，但允许用户把程序分为若干个任务，使他们并发执行。
3. 多用户多任务操作系统：允许多个用户通过各自的终端，使用同一台机器，共享主机系统中的各种资源，而每一个用户程序又可进一步分为几个任务，使他们并发执行。

## 1.3 操作系统的基本特性*

### 1.3.1 并发(最基本)

1. 并发与并行：
   - 并发性：是指两个或多个事件在**同一时间间隔**内发生。
   - 并行性：是指两个或多个事件在**同一时刻**发送。
2. 引入进程：
   - 所谓进程，是指在系统中能独立运行并作为资源分配的基本单位。
   - 多个进程之间可以并发执行和交换信息。

### 1.3.2 共享

1. 互斥共享方式：
   - 系统中某些资源虽然可以给多个进程(线程)使用，但应规定在一段时间内，只允许一个进程访问该资源。
   - 系统建立一种机制，保证多个进程对这类资源的互斥访问。
2. 同时访问方式：
   - 有些资源，在宏观上，各个进程(线程)是在同时使用的，但在微观上，实际是对该资源进行交替访问。

### 1.3.3 虚拟

1. 时分复用技术：该种方式提高资源利用率的根本原因在于，它利用某设备为一用户服务的空闲时间，又转去为其他用户服务。
   - 虚拟处理机技术：利用多道程序设计技术，为每道程序建立至少一个进程，让多道程序并发执行。
   - 虚拟设备技术：利用虚拟设备技术，将一台物理I/O设备虚拟为多台逻辑上的I/O设备，并允许每个用户占用一台逻辑上的I/O设备。
2. 空分复用技术：是指将一个频带范围比较宽的信道划分成多个频带范围较窄的信道(称为频带)。
3. 时分复用与空分复用比较：
   - 多道程序技术(时分复用技术)是通过利用处理机的空闲时间运行其他程序。提高了处理机的利用率。
   - 空分复用技术是利用存储器的空闲空间分区存放和运行其它的多道程序，以此来提高内存的利用率。

### 1.3.4 异步

## 1.4 操作系统的主要功能(1:12:43)

传统的OS中应具有处理机管理、存储器管理、设备管理和文件管理等基本功能，为用户使用方便，还应该向用户提供方便的用户接口。

# 第二章 进程的描述与控制

## 2.1 前趋图和程序执行

### 2.1.1 前趋图

- 前趋图是指一个有向无循环图，可记为DAG，它用于描述进程之间执行的先后顺序。
- 应当注意，前趋图中不允许有循环。

### 2.1.2 程序顺序执行

程序顺序执行时的特征：

- 顺序性；指处理机严格按照程序所规定的顺序执行，即每一操作必须在下一操作开始之前结束。
- 封闭性；指程序在封闭的环境下运行，即程序运行时独占全机资源，程序的状态只有本程序才能改变它，程序一旦开始，其执行结果不受外界因素影响。
- 可再现性。指只要程序执行时的环境和初始条件相同，当程序重复执行时，都可以获得相同的结果。

### 2.1.3 程序并发执行

只有在不存在前趋关系的程序之间才有可能并发执行，否则无法并发执行。

程序并发执行时的特征：

- 间断性；程序在并发执行时，由于它们共享系统资源，以及为完成同一项任务而相互合作，致使在这些并发执行的程序之间形成了相互制约的关系。
- 失去封闭性；当系统中存在着多个可以并发执行的程序时，系统中的各种资源将为它们所共享，这些资源的状态也由这些程序来改变，致使其中任一程序在运行时，其环境都必然会受到其它程序的影响。
- 不可再现性。程序在并发执行时，由于失去了封闭性，也将导致其又失去可再现性。

## 2.2 进程的描述

### 2.2.1 进程的定义和特征

1. 进程的定义：

   - 为了使参与并发执行的每个程序(含数据)都能独立地运行，在操作系统中必须为之配置一个专门的数据结构，称为进程控制块(PCB)。
   - 由程序段、数据段和PCB三部分便构成了进程实体(又称进程映像)。

   进程比较典型的定义有：

   - 进程是程序的一次执行；
   - 进程是一个程序及其数据在处理机上顺序执行时所发生的活动；
   - 进程是具有独立功能的程序在一个数据集合上运行的过程，它是系统进行资源分配和调度的一个独立单位。
   
2. 进程的特征：

   - 动态性(最基本)：进程的实质是进程实体的执行过程。
   - 并发性：指多个进程实体同存于内存中，且能在一段时间内同时运行。
   - 独立性：在传统的OS中，独立性是指进程实体是一个能独立运行、独立获得资源和独立接受调度的基本单位，凡未建立PCB的程序都不能作为一个独立的单位参与运行。
   - 异步性：指进程按异步方式运行，即按各自独立的、不可预知的速度向前推进。

### 2.2.2 进程的基本状态及转换

1. 进程的基本状态：
   - 就绪(Ready)状态：指进程处于准备好运行的状态。
   - 执行(Running)状态：指进程已获得CPU，其程序正在执行的状态。
   - 阻塞(Block)状态：指正在执行的进程由于发生某事件(如I/O请求、申请缓冲区失败等)**暂时**无法继续执行时的状态。通常系统将处于阻塞状态的进程排成一个队列，称该队列为阻塞队列。
2. 三种基本状态的转换：

![进程三种基本状态及其转换](https://github.com/wangjtkw/Test/blob/master/img/%E8%BF%9B%E7%A8%8B%E4%B8%89%E7%A7%8D%E5%9F%BA%E6%9C%AC%E7%8A%B6%E6%80%81%E5%8F%8A%E5%85%B6%E8%BD%AC%E6%8D%A2.jpg)